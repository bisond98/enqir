import{r as c,j as d,H as V,M as L}from"./index-BjPfBPAr.js";const h={enableTouchGestures:!0,enableVoiceCommands:!0,enableOfflineAI:!0,enableMobileOptimization:!0,touchSensitivity:.7,voiceRecognitionThreshold:.6,offlineCacheSize:50,mobilePerformanceMode:"medium"},X=async(e={})=>{try{const t={...h,...e},n=await Y();return n.touchSupport||(t.enableTouchGestures=!1),n.voiceSupport||(t.enableVoiceCommands=!1),t.enableOfflineAI&&await N(t.offlineCacheSize),await j(t.mobilePerformanceMode),console.log("ðŸ“± Mobile AI Experience initialized:",t),!0}catch(t){return console.error("Mobile AI initialization failed:",t),!1}},Y=async()=>{try{const e="ontouchstart"in window||navigator.maxTouchPoints>0,t="webkitSpeechRecognition"in window||"SpeechRecognition"in window,n="serviceWorker"in navigator;let o="medium";return navigator.hardwareConcurrency&&(navigator.hardwareConcurrency>=8?o="high":navigator.hardwareConcurrency>=4?o="medium":o="low"),{touchSupport:e,voiceSupport:t,offlineSupport:n,performanceLevel:o}}catch(e){return console.error("Device capability check failed:",e),{touchSupport:!1,voiceSupport:!1,offlineSupport:!1,performanceLevel:"medium"}}},N=async e=>{try{if("caches"in window){const t=await caches.open("ai-offline-cache");console.log("ðŸ“± Offline AI cache initialized with size:",e,"MB")}}catch(t){console.error("Offline cache initialization failed:",t)}},j=async e=>{try{switch(e){case"low":console.log("ðŸ“± Mobile AI: Low performance mode enabled");break;case"high":console.log("ðŸ“± Mobile AI: High performance mode enabled");break;default:console.log("ðŸ“± Mobile AI: Balanced performance mode enabled")}}catch(t){console.error("Performance mode setting failed:",t)}},O=async(e,t={})=>{try{const n={...h,...t};if(!n.enableTouchGestures)return null;if(typeof TouchEvent>"u")return console.warn("TouchEvent not available in this environment"),null;const o=_(e),s=P(o,n.touchSensitivity);return s&&console.log("ðŸ“± Touch gesture recognized:",s),s}catch(n){return console.error("Touch gesture recognition failed:",n),null}},_=e=>{try{let t=0,n=0,o=0,s=0,r=0,a=0;typeof TouchEvent<"u"&&e instanceof TouchEvent?(e.touches.length>0&&(t=e.touches[0].clientX,n=e.touches[0].clientY,r=e.timeStamp),e.changedTouches.length>0&&(o=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY,a=e.timeStamp)):e instanceof MouseEvent&&(t=e.clientX,n=e.clientY,r=e.timeStamp,o=e.clientX,s=e.clientY,a=e.timeStamp);const g=a-r,b=Math.sqrt(Math.pow(o-t,2)+Math.pow(s-n,2)),u=b/Math.max(g,1);return{startTime:r,endTime:a,startX:t,startY:n,endX:o,endY:s,duration:g,distance:b,velocity:u}}catch(t){return console.error("Touch data extraction failed:",t),{startTime:0,endTime:0,startX:0,startY:0,endX:0,endY:0,duration:0,distance:0,velocity:0}}},P=(e,t)=>{try{const{duration:n,distance:o,velocity:s}=e;if(o>50*t&&n<500){const r=e.endX-e.startX,a=e.endY-e.startY;return Math.abs(r)>Math.abs(a)?{type:"swipe",direction:r>0?"right":"left",intensity:Math.min(1,Math.abs(r)/200),duration:n,coordinates:{x:e.endX,y:e.endY}}:{type:"swipe",direction:a>0?"down":"up",intensity:Math.min(1,Math.abs(a)/200),duration:n,coordinates:{x:e.endX,y:e.endY}}}return n>500*t&&o<10?{type:"longPress",intensity:Math.min(1,n/1e3),duration:n,coordinates:{x:e.endX,y:e.endY}}:n<200&&o<10?{type:"doubleTap",intensity:1,duration:n,coordinates:{x:e.endX,y:e.endY}}:null}catch(n){return console.error("Touch data analysis failed:",n),null}},G=async(e,t={})=>{try{const n={...h,...t};if(!n.enableVoiceCommands)return null;const o=await q(e,n.voiceRecognitionThreshold);return o&&console.log("ðŸ“± Voice command recognized:",o),o}catch(n){return console.error("Voice command recognition failed:",n),null}},q=async(e,t)=>{try{const n=e.size,o=n/16e3;let s="",r="",a=Math.random()*.3+.7;return o>2?(s="search for enquiries",r="search"):o>1?(s="post new enquiry",r="post"):(s="show dashboard",r="navigate"),a<t?null:{command:s,confidence:a,action:r,parameters:{duration:o,audioSize:n},fallback:"Please try speaking more clearly"}}catch(n){return console.error("Voice recognition simulation failed:",n),null}},B=(e={})=>{try{const t={...h,...e};return window.innerWidth<768&&(t.mobilePerformanceMode="low",t.offlineCacheSize=25,t.touchSensitivity=.8),t}catch(t){return console.error("Mobile AI config generation failed:",t),h}},W=()=>{try{if(!navigator.onLine)return"offline";if("connection"in navigator){const e=navigator.connection;if(e.effectiveType==="slow-2g"||e.effectiveType==="2g")return"poor"}return"online"}catch(e){return console.error("Network status check failed:",e),"online"}},E=(e={})=>{try{const t={...h,...e},n=W();return{isTouchEnabled:t.enableTouchGestures,isVoiceEnabled:t.enableVoiceCommands,isOfflineMode:n==="offline"&&t.enableOfflineAI,currentGesture:null,lastVoiceCommand:null,performanceMode:t.mobilePerformanceMode,networkStatus:n}}catch(t){return console.error("Mobile AI state generation failed:",t),{isTouchEnabled:!1,isVoiceEnabled:!1,isOfflineMode:!1,currentGesture:null,lastVoiceCommand:null,performanceMode:"medium",networkStatus:"online"}}},k=async(e,t={})=>{try{const n={...h,...t};if(e.type==="swipe")switch(e.direction){case"left":return{success:!0,action:"next_item",result:"Swiped left to next item"};case"right":return{success:!0,action:"previous_item",result:"Swiped right to previous item"};case"up":return{success:!0,action:"refresh",result:"Swiped up to refresh"};case"down":return{success:!0,action:"load_more",result:"Swiped down to load more"};default:return{success:!1,action:"unknown_swipe"}}if(e.type==="longPress")return{success:!0,action:"context_menu",result:"Long press for context menu"};if(e.type==="doubleTap")return{success:!0,action:"quick_action",result:"Double tap for quick action"};if("command"in e)switch(e.action){case"search":return{success:!0,action:"search",result:`Searching for: ${e.command}`};case"post":return{success:!0,action:"navigate",result:"Navigating to post enquiry"};case"navigate":return{success:!0,action:"navigate",result:`Navigating to: ${e.command}`};default:return{success:!1,action:"unknown_voice_command"}}return{success:!1,action:"unknown_input"}}catch(n){return console.error("Mobile AI action execution failed:",n),{success:!1,action:"execution_error"}}},H=({children:e,onGesture:t,onVoiceCommand:n,config:o={},className:s=""})=>{const[r,a]=c.useState(!1),[g,b]=c.useState(!1),[u,T]=c.useState(null),[v,S]=c.useState(null),[C,I]=c.useState(null);c.useState(!1);const M=c.useRef(null),p=c.useRef(null),x=c.useRef([]);c.useEffect(()=>{let i=!0;const m=setTimeout(async()=>{try{if(window.innerWidth>1024&&!o.enableMobileOptimization){console.log("ðŸ“± Mobile AI: Skipping on desktop for performance"),a(!1);return}console.log("ðŸ” Starting Mobile AI initialization...");const f=await X(o);if(i&&(console.log("ðŸ” Mobile AI init result:",f),a(f),f)){const z=E(o);T(z);const A=setInterval(()=>{if(i){const R=E(o);T(R)}},1e4);return()=>clearInterval(A)}}catch(f){console.error("âŒ Mobile AI initialization failed:",f),i&&a(!1)}},1e3);return()=>{i=!1,clearTimeout(m)}},[o]);const w=c.useCallback(async i=>{if(!(!r||!(u!=null&&u.isTouchEnabled)))try{const l=await O(i,o);if(l){S(l);const m=await k(l,o);console.log("ðŸ“± Gesture executed:",m),t&&t(l),setTimeout(()=>S(null),2e3)}}catch(l){console.error("Touch gesture handling failed:",l)}},[r,u,o,t]),y=c.useCallback(i=>{},[]);return c.useCallback(async()=>{try{if(!r||!(u!=null&&u.isVoiceEnabled))return;const i=await navigator.mediaDevices.getUserMedia({audio:!0});p.current=new MediaRecorder(i),x.current=[],p.current.ondataavailable=l=>{x.current.push(l.data)},p.current.onstop=async()=>{const l=new Blob(x.current,{type:"audio/wav"}),m=await G(l,o);if(m){I(m);const f=await k(m,o);console.log("ðŸ“± Voice command executed:",f),n&&n(m),setTimeout(()=>I(null),3e3)}i.getTracks().forEach(f=>f.stop())},p.current.start(),b(!0)}catch(i){console.error("Voice recording failed:",i)}},[r,u,o,n]),c.useCallback(()=>{p.current&&g&&(p.current.stop(),b(!1))},[g]),c.useEffect(()=>{if(!M.current||!r)return;const i=M.current;return i.addEventListener("touchstart",w),i.addEventListener("touchend",y),i.addEventListener("mousedown",w),i.addEventListener("mouseup",y),()=>{i.removeEventListener("touchstart",w),i.removeEventListener("touchend",y),i.removeEventListener("mousedown",w),i.removeEventListener("mouseup",y)}},[w,y,r]),B(o),!r||window.innerWidth>1024&&!o.enableMobileOptimization?d.jsx("div",{className:s,children:e}):d.jsxs("div",{ref:M,className:`relative ${s}`,children:[v&&d.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50",children:d.jsxs("div",{className:"bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2",children:[d.jsx(V,{className:"w-4 h-4"}),d.jsxs("span",{className:"text-sm font-medium",children:[v.type," ",v.direction&&`(${v.direction})`]})]})}),C&&d.jsx("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 z-50",children:d.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2",children:[d.jsx(L,{className:"w-4 h-4"}),d.jsxs("span",{className:"text-sm font-medium",children:['"',C.command,'"']})]})}),e]})};export{H as default};
